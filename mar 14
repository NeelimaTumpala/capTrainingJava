//connecting jdk to sql
//values taken from user/connecting jdk to sql/creating a table and inserting into it
//connecting jdk to sql/creating a table and inserting into it
//to update student list in sql using jdk


//connecting jdk to sql
package jdbc;

import java.sql.DriverManager;
import java.sql.SQLException;

import oracle.jdbc.OracleDriver;

public class TestDB {

	public static void main(String[] args) throws SQLException {
		DriverManager.registerDriver(new OracleDriver());
		String url = "jdbc:oracle:thin:@localhost:1521:xe";
		DriverManager.getConnection(url,"neelima","daaji");
		System.out.println("connected");

	}

}

//values taken from user
//connecting jdk to sql
//creating a table and inserting into it
package jdbc;

import java.beans.Statement;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.util.Scanner;

import oracle.jdbc.OracleDriver;

public class TestDB {

	public static void main(String[] args) throws SQLException {
		DriverManager.registerDriver(new OracleDriver());
		String url = "jdbc:oracle:thin:@localhost:1521:xe";
		Connection conn = DriverManager.getConnection(url,"neelima","daaji");
		System.out.println("connected");
		/*
		java.sql.Statement st = conn.createStatement();
		String qry = "insert into studentt values(101,'mlk',80,90)";
		st.executeUpdate(qry);
		System.out.println("inserted");*/
		Scanner sc = new Scanner(System.in);
		String qry2  = "insert into studentt values(?,?,?,?)";
		PreparedStatement pst = conn.prepareStatement(qry2);
		int regno = sc.nextInt();
		String stuname = sc.next();
		int sub1 = sc.nextInt();
		int sub2 = sc.nextInt();
		pst.setInt(1, regno);
		pst.setString(2, stuname);
		pst.setInt(3, sub1);
		pst.setInt(4, sub2);
		pst.executeUpdate();
		System.out.println("inserted");
		

	}

}

//connecting jdk to sql
//creating a table and inserting into it
package jdbc;

import java.beans.Statement;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;

import oracle.jdbc.OracleDriver;

public class TestDB {

	public static void main(String[] args) throws SQLException {
		DriverManager.registerDriver(new OracleDriver());
		String url = "jdbc:oracle:thin:@localhost:1521:xe";
		Connection conn = DriverManager.getConnection(url,"neelima","daaji");
		System.out.println("connected");
		/*
		java.sql.Statement st = conn.createStatement();
		String qry = "insert into studentt values(101,'mlk',80,90)";
		st.executeUpdate(qry);
		System.out.println("inserted");*/
		String qry2  = "insert into studentt values(?,?,?,?)";
		PreparedStatement pst = conn.prepareStatement(qry2);
		pst.setInt(1, 104);
		pst.setString(2, "james gosling");
		pst.setInt(3, 80);
		pst.setInt(4, 60);
		pst.executeUpdate();
		System.out.println("inserted");
		

	}

}


//what i done in sql command line while writing this code

SQL> connect neelima;
Enter password:
Connected.

SQL> create table sample(id number(3), name varchar(10));

Table created.

SQL> insert into sample values(21,'jai');

1 row created.

SQL> insert into sample values(22,'cha');

1 row created.

SQL> insert into sample values(23,'aaa');

1 row created.

SQL> insert into sample values(&id,'&name');
Enter value for id: 24
Enter value for name: bbb
old   1: insert into sample values(&id,'&name')
new   1: insert into sample values(24,'bbb')

1 row created.
SQL> /
Enter value for id: 25
Enter value for name: ccc
old   1: insert into sample values(&id,'&name')
new   1: insert into sample values(25,'ccc')

1 row created.

SQL> select * from tab;

TNAME                          TABTYPE  CLUSTERID
------------------------------ ------- ----------
DEPARTMENT                     TABLE
DEPARTMENT_MASTER              TABLE
EMP                            TABLE
EMPLOYEE                       TABLE
SAMPLE                         TABLE
STUDENT                        TABLE
STUDENT_MARKS                  TABLE
STUDENT_MASTER                 TABLE
TESTDATE                       TABLE
XYZ_MASTER                     TABLE

10 rows selected.

SQL> create table studentt(regno number(4) primary key,stuname varchar(20),sub1 number(3),sub2 number(3));

Table created.

SQL> select * from studentt;

     REGNO STUNAME                    SUB1       SUB2
---------- -------------------- ---------- ----------
       101 mlk                          80         90

SQL> select * from studentt;

     REGNO STUNAME                    SUB1       SUB2
---------- -------------------- ---------- ----------
       101 mlk                          80         90
       104 james gosling                80         60
       
       
       
//to update student list in sql using jdk
package jdbc;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;

import oracle.jdbc.OracleDriver;

public class UpdateEx {

	public static void main(String[] args) throws SQLException {
		DriverManager.registerDriver(new OracleDriver());
		String url = "jdbc:oracle:thin:@localhost:1521:xe";
		Connection conn = DriverManager.getConnection(url,"neelima","daaji");
		System.out.println("connected");
		String qry  = "update studentt set sub1=?, sub2=? where regno=?";
		PreparedStatement pst = conn.prepareStatement(qry);
		pst.setInt(1, 98);
		pst.setInt(2, 89);
		pst.setInt(3, 104);
		pst.executeUpdate();
		System.out.println("updated");

	}

}

//in sql after updating
SQL> select * from studentt;

     REGNO STUNAME                    SUB1       SUB2
---------- -------------------- ---------- ----------
       101 mlk                          80         90
       104 james gosling                98         89


//to get students list from sql using jdk
package jdbc;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.ResultSetMetaData;
import java.sql.SQLException;
import java.sql.Statement;

import oracle.jdbc.OracleDriver;

public class GetStudents {

	public static void main(String[] args) throws SQLException {
		DriverManager.registerDriver(new OracleDriver());
		String url = "jdbc:oracle:thin:@localhost:1521:xe";
		Connection conn = DriverManager.getConnection(url,"neelima","daaji");
		System.out.println("connected");
		String sql = "Select * from studentt";
		Statement st = conn.createStatement();
		ResultSet rs = st.executeQuery(sql);
		ResultSetMetaData rsmd = rs.getMetaData();
		for(int i=1;i<=rsmd.getColumnCount();i++)
			System.out.print(rsmd.getColumnName(i)+" ");
		System.out.println("\n---------------------------");	
		while(rs.next())
			System.out.println(rs.getInt(1)+" "+rs.getString("stuname")+
					" "+rs.getInt(3)+" "+rs.getInt(4));

	}

}


in output console table in sql will be printed


//
package com.cg.students.applications;

import com.cg.students.beans.Student;
import com.cg.students.service.StudentService;
import com.cg.students.service.StudentServiceImpl;

public class AddStudent {
	public static void main(String[] args) {
		StudentService service = new StudentServiceImpl();
		Student std = new Student(101,"mlk","cse",new Date(),800);
		int rows = service.addStudent(std);
		if(rows>0)
			System.out.println("inserted");
		else
			System.out.println("not inserted");
	}

}


//

package com.cg.students.beans;

import java.sql.Date;

public class Student {
	private int regno;
	private String studentName;
	private String branch;
	private Date birthdate;
	private int totalmarks;
	public Student() {
		
	}
	public Student(int regno, String studentName, String branch, Date birthdate, int totalmarks) {
		super();
		this.regno = regno;
		this.studentName = studentName;
		this.branch = branch;
		this.birthdate = birthdate;
		this.totalmarks = totalmarks;
	}
	public int getRegno() {
		return regno;
	}
	public void setRegno(int regno) {
		this.regno = regno;
	}
	public String getStudentName() {
		return studentName;
	}
	public void setStudentName(String studentName) {
		this.studentName = studentName;
	}
	public String getBranch() {
		return branch;
	}
	public void setBranch(String branch) {
		this.branch = branch;
	}
	public Date getBirthdate() {
		return birthdate;
	}
	public void setBirthdate(Date birthdate) {
		this.birthdate = birthdate;
	}
	public int getTotalmarks() {
		return totalmarks;
	}
	public void setTotalmarks(int totalmarks) {
		this.totalmarks = totalmarks;
	}
	
}


//

package com.cg.students.dao;

import com.cg.students.beans.Student;

public interface StudentDao {
	public int addStudent(Student std);
}


//

package com.cg.students.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;

import com.cg.students.beans.Student;
import com.cg.students.utils.DBConnection;
import com.cg.students.utils.DBQueries;

public class StudentDaoImpl implements StudentDao{
	Connection conn =null;
	PreparedStatement pst;
	
	@Override
	public int addStudent(Student std) {
		conn = DBConnection.getDBConnection();
		int rows = 0;
		try {
			pst = conn.prepareStatement(DBQueries.addStudent);
			pst.setInt(1,std.getRegno());
			pst.setString(2, std.getStudentName());
			pst.setString(3, std.getBranch());
			//converting java.util.date to java.sql.Date
			Date sqldate = new Date(std.getBirthdate().getTime());
			pst.setDate(4, sqldate);
			pst.setInt(5, std.getTotalMarks());
			rows = pst.executeUpdate();
		}catch(SQLException e) {
			e.printStackTrace();
		}
		finally {
			try {
				conn.close();
			}catch(SQLException e) {
				e.printStackTrace();
			}
		}
		return rows;
	}
	
}


//

package com.cg.students.service;

import com.cg.students.beans.Student;

public interface StudentService {
	public int addStudent(Student std);

}


//

package com.cg.students.service;

import com.cg.students.beans.Student;
import com.cg.students.dao.StudentDao;
import com.cg.students.dao.StudentDaoImpl;

public class StudentServiceImpl implements StudentService{
	private StudentDao dao = new StudentDaoImpl();
	@Override
	public int addStudent(Student std) {
		int rows = dao.addStudent(std);
		
		return rows;
	}

}


//

package com.cg.students.utils;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;

import oracle.jdbc.OracleDriver;

public class DBConnection {
	public static Connection conn = null;
	public static Connection getDBConnection() {
		String url = "jdbc:oracle:thin:@localhost:1521:xe";
		String username = "neelima";
		String password = "daaji";
		try {
			DriverManager.registerDriver(new OracleDriver());
			conn = DriverManager.getConnection(url,username,password);
			
		}catch(SQLException e) {
			e.printStackTrace();
		}
		return conn;
	}

}


//

package com.cg.students.utils;

public class DBQueries {
	public static String addStudent = "insert into student values(?,?,?,?,?)";
	
}
